# Quark Configurator (可视化交互版) - 开发计划

**项目名称**: Quark Configurator (可视化交互版)
**目标**: 开发一个基于 PySide6 的桌面应用程序，提供直观的量子计算实验配置文件的查看、编辑功能，并结合量子芯片拓扑图和实时数据可视化，提升操作人员的交互体验和效率。

---

## 1. 技术栈

*   **GUI 框架**: PySide6 (Python + Qt)
*   **数据处理**: NumPy, SciPy (Python 标准科学计算库)
*   **绘图**: Matplotlib (通过 `FigureCanvasQTAgg` 集成到 Qt UI 中)
*   **后端通信**: `quark.app.s` (与 QuarkServer 进行交互)
*   **数据格式**: JSON (配置文件)

---

## 2. 核心功能与 UI 架构

应用程序将采用经典的三栏布局，实现功能模块化：

*   **左侧面板 (配置导航)**:
    *   **功能**: 提供配置文件的主要分类导航（如 `dev`, `station`, `etc`, `gate`）。
    *   **交互**: 点击导航项时，右侧的“参数编辑区”动态加载相应表单。
*   **中间面板 (量子芯片拓扑图)**:
    *   **功能**: 直观展示量子芯片的物理布局，比特和耦合器作为可交互的图形元素。
    *   **实现**: 基于 `QGraphicsView` 和 `QGraphicsScene`。
    *   **交互**:
        *   **点击比特/耦合器**: 高亮选中元素，并在右侧“参数编辑区”加载其相关参数，同时在“绘图区”显示相关可视化数据。
        *   **视觉反馈**: 根据校准状态（例如，参数是否为默认值）改变比特节点的颜色或图标。
*   **右侧面板 (动态参数编辑与绘图区)**:
    *   **功能**: 根据中间面板的选择，动态显示相关参数的编辑表单和数据可视化。
    *   **实现**: 使用 `QStackedWidget` 和 `QTabWidget` 组合，以及 `Matplotlib` 集成。
    *   **参数编辑**:
        *   显示选中比特/耦合器的详细门参数（如 `frequency`, `amp`, `duration`, `threshold`）。
        *   使用合适的 Qt 控件（`QDoubleSpinBox`, `QLineEdit` 等）进行编辑。
        *   **数据同步**: 用户修改后，通过 `quark.app.s` 实时更新 `QuarkServer` 中的参数。
    *   **绘图区**:
        *   **2D 能谱图**: 显示选中比特的能谱数据（可能需要 `QuarkServer` 提供实时数据接口）。
        *   **邻近比特频率排布图**: 显示选中比特及其邻近比特的频率分布，帮助用户选择工作点。

---

## 3. 开发路线图 (分阶段执行)

### 阶段 1: 基础框架与配置加载 (MVP)
*   **目标**: 构建应用程序骨架，实现配置文件的加载和基本显示。
*   **任务**:
    *   创建 PySide6 项目结构。
    *   设计并实现三栏主窗口布局。
    *   实现左侧面板的配置导航树（`dev`, `station`, `etc`, `gate`）。
    *   通过 `quark.app.s` 从 `QuarkServer` 加载当前配置文件的所有内容。
    *   实现右侧面板的**只读**参数显示，能够根据左侧导航显示对应部分的 JSON 结构或简单表格。
*   **交付物**: 可运行的桌面应用，能够加载并显示配置文件内容。

### 阶段 2: 交互式拓扑图与基本编辑
*   **目标**: 实现量子芯片拓扑图的绘制和交互，并使核心配置参数可编辑。
*   **任务**:
    *   定义并加载**芯片拓扑定义文件**（例如，`home/lib/arch/chip_topology.json`，包含比特 ID、坐标、连接关系）。
    *   在中间面板实现 `QGraphicsView`，根据拓扑定义文件绘制量子比特节点和耦合器边。
    *   实现比特/耦合器节点的点击高亮功能。
    *   实现右侧面板的**可编辑**参数表单，能够通过 `s.update()` 将修改后的参数写回 `QuarkServer`。
    *   实现点击比特/耦合器时，右侧面板动态加载对应参数表单的功能。
*   **交付物**: 可视化拓扑图，核心参数可编辑并同步到 `QuarkServer`。

### 阶段 3: 高级可视化与用户体验
*   **目标**: 增强可视化功能，提升用户体验和数据洞察力。
*   **任务**:
    *   实现右侧面板的**邻近比特频率排布图**（从配置文件中读取数据并绘制）。
    *   实现 2D 能谱图的绘制（初期可使用模拟数据或预存数据，或与 `QuarkServer` 团队协作获取实时数据接口）。
    *   在拓扑图上实现比特状态的视觉反馈（例如，根据校准状态改变节点颜色）。
    *   添加文件保存/另存为功能，将 `QuarkServer` 中的当前配置导出为 JSON 文件。
    *   实现基本的数据验证，防止非法输入。
*   **交付物**: 具备高级可视化和良好用户体验的 Quark Configurator。

---

## 4. 依赖与集成

*   **`QuarkServer` 运行**: 本工具依赖于 `QuarkServer` 的正常运行，所有数据交互都通过 `quark.app.s` 进行。
*   **配置文件**: 工具将读取和修改 `QuarkServer` 当前加载的配置文件。
*   **驱动文件**: `dev` 部分的 `name` 字段将与 `home/dev/` 目录下的驱动文件关联。
*   **芯片拓扑文件**: 需要一个独立的 JSON 文件来描述芯片的物理布局。

---

## 5. 成功标准

*   应用程序能够稳定运行，无崩溃。
*   所有配置文件中的参数都可以在 UI 中正确显示和编辑。
*   参数修改能够实时同步到 `QuarkServer`。
*   量子芯片拓扑图能够准确反映芯片结构，并支持交互。
*   绘图区能够正确显示能谱和频率排布图。
*   操作人员能够通过该工具直观地理解和管理实验配置。
